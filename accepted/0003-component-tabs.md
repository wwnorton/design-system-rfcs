- Start Date: 2022/04/11
- Related documents:
  - [acceptance criteria](https://wwnorton.atlassian.net/browse/NDS-235)
  - [documentation draft](https://docs.google.com/document/d/1D0MjvCYdCaaHDJGYcPk8u9pSREkVpAac8JqNYzviHc0)
  - [visual design](@TODO)
- [RFC PR](https://github.com/wwnorton/design-system-rfcs/pull/5)

## Summary

`Tabs` allow the user to select layered sections of content to display within the same space.

A list of tab headers is displayed using the `TabList` and `Tab` components, allowing the user to interact and select the tab content they want to see. The contents of each tab is contained in a `TabPanel` component, all wrapped within a `TabPanels` container.

### Sub components

- `<Tabs>` - The highest-order wrapper that contains all the other sub-components. Handles data management and distribution across it's children
- `<TabList>` - Container for the `<Tab>` components
- `<Tab>` - An interactive button within the `TabList`, allows the user to navigate between the different sections of content
- `<TabPanels>` - Container for the `<TabPanel>` components
- `<TabPanel>` - Container for the content of each section, contained within `TabPanels`

## Detailed design

A stateful component with both uncontrolled and controlled versions (state managed internally / state managed externally).

The only state managed by this component is the currently active section of content, identified by its index. `Tab` components must be in order with its corresponding `TabPanel`s in order to assure that the `Tab` buttons activate the correct section of content

### Tabs

`<Tabs>` extends the `React.ComponentPropsWithRef<'div'>` interface and adds the following props:

| Name           | Type                                                         | Description                                                                                                                    | Required | Default     |
| -------------- | ------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------ | -------- | ----------- |
| `value`        | `number`                                                     | The currently active tab, for controlled use only                                                                              | `false`  | `undefined` |
| `onChange`     | `(payload: { value: number; contents: ReactNode; }) => void` | Callback for when the user interacts with one of the `Tab` buttons                                                             | `false`  | 0           |
| `initialValue` | `number`                                                     | Sets the default value for the currently active tab, for uncontrolled use only. Will be ignored if the `value` prop is defined | `false`  | `undefined` |

### TabList

`<TabList>` extends the `React.ComponentPropsWithRef<'div'>` interface with a `role="tablist"` attribute.

### Tab

`<Tab>` extends the `React.ComponentPropsWithRef<'button'>` interface with `role="tab"`, `aria-selected="true/false"` and `aria-controls="tab-ID"` (an autogenerated unique prefix might be needed to support the case were there are multiple tab components rendered at the same time and share tab names) attributes. The values for `aria-selected` and `aria-controls` should be calculated using the state delivered by the `Tabs` wrapper

| Name    | Type        | Description                                                                                                                                                      | Required | Default     |
| ------- | ----------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------- | ----------- |
| `value` | `React.Key` | An unique key to identify this `Tab`, must be the same as the value provided to its corresponding `TabPanel`. If unset, the children position index will be used | `false`  | `undefined` |

### TabPanels

`<TabPanels>` extends the `React.ComponentPropsWithRef<'div'>` interface.

### TabPanel

`<TabPanel>` extends the `React.ComponentPropsWithRef<'div'>` interface with `role="tabpanel"` and an `id` attributes.

| Name    | Type        | Description                                                                                                                                                      | Required | Default     |
| ------- | ----------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------- | ----------- |
| `value` | `React.Key` | An unique key to identify this `TabPanel`, must be the same as the value provided to its corresponding `Tab`. If unset, the children position index will be used | `false`  | `undefined` |

### Simple Usage - Uncontrolled/State managed internally

```tsx
<Tabs initialValue={2}>
  <TabList>
    <Tab>Cats</Tab>
    <Tab>Dogs</Tab>
    <Tab>Horses</Tab>
  </TabList>
  <TabPanels>
    <TabPanel>Cats content</TabPanel>
    <TabPanel>Dogs content</TabPanel>
    <TabPanel>Horses content</TabPanel>
  </TabPanels>
</Tabs>
```

### Simple Usage - Controlled/State managed externally

```tsx
<Tabs value={activeTabindex} onChange={handleActiveTabChange}>
  <TabList>
    <Tab>Cats</Tab>
    <Tab>Dogs</Tab>
    <Tab>Horses</Tab>
  </TabList>
  <TabPanels>
    <TabPanel>Cats content</TabPanel>
    <TabPanel>Dogs content</TabPanel>
    <TabPanel>Horses content</TabPanel>
  </TabPanels>
</Tabs>
```

### Simple example of final rendered HTML

```tsx
<div role="tablist" aria-label="animals">
  <button
    type="button"
    role="tab"
    aria-selected="true"
    aria-controls="cats-tab"
    id="cats"
  >
    Cats
  </button>
  <button
    type="button"
    role="tab"
    aria-selected="false"
    aria-controls="dogs-tab"
    id="dogs"
  >
    Dogs
  </button>
  <button
    type="button"
    role="tab"
    aria-selected="false"
    aria-controls="horses-tab"
    id="horses"
  >
    Horses
  </button>

  <div className="panel-container">
    <div id="cats-tab" role="tabpanel" aria-labelledby="cats">
      Cats content
    </div>
    <div id="dogs-tab" role="tabpanel" aria-labelledby="dogs" hidden="">
      Dogs content
    </div>
    <div id="horses-tab" role="tabpanel" aria-labelledby="horses" hidden="">
      Horses content
    </div>
  </div>
</div>
```

## Alternatives

Ant-design uses a simpler and more minimalistic API, which combines the `Tab` and `TabPanel` components into one and only a single `Tabs` wrapper. A clear disadvantage of this API is that it doesn't reflect the structure of the actual rendered HTML. Also it requires a more complex implementation due to the need to use Portals in order to elevate the tab content above its container in the final DOM.

```tsx
<Tabs defaultActiveKey="1" onChange={callback}>
  <TabPane tab="Tab 1" key="1">
    Content of Tab Pane 1
  </TabPane>
  <TabPane tab="Tab 2" key="2">
    Content of Tab Pane 2
  </TabPane>
  <TabPane tab="Tab 3" key="3">
    Content of Tab Pane 3
  </TabPane>
</Tabs>
```

## Unresolved questions

- We need a way to identify each `Tab` and relate it to its corresponding `TabPanel`. This is needed to keep track of currently active tab and setting the `aria-controls` attribute

We can:

1. Force the user to provide a `value: React.Key` prop to each `Tab` and `TabPanel` (expecting the key to be equal for corresponding tab/tabPanel pairs) and use that
2. Make it optional, and when none is provided, fallback to the children position index. Both the `TabList` and `TabPanels` parents will most likely need to iterate over its children props and check whether they have a `value` prop or not and inject its corresponding index as `value` if needed
